# Mini LoongEnv-Studio 设计方案

## 1. 核心功能范围

### 最小可行产品(MVP)功能
```
核心工作流:
创建项目 → 配置机械臂 → 设计轨迹 → 预览仿真 → 导出配置

精简功能列表:
├── 项目管理 (简化)
│   ├── 创建新项目
│   ├── 项目列表
│   └── 基本项目信息
├── 机械臂配置 (核心)
│   ├── 6轴机械臂DH参数
│   ├── 关节限制设置
│   └── 3D模型显示
├── 轨迹设计 (核心)
│   ├── 3D空间点击添加轨迹点
│   ├── 轨迹点位置编辑
│   └── 轨迹路径可视化
├── 简单仿真 (核心)
│   ├── 运动学仿真
│   ├── 轨迹跟踪显示
│   └── 基本性能指标
└── 配置导出 (核心)
    ├── JSON格式配置文件
    └── 基本项目报告
```

## 2. 技术栈简化

### 前端技术栈 (最小化)
```typescript
{
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "typescript": "^5.0.0",
    "antd": "^5.12.0",           // UI组件库
    "three": "^0.158.0",         // 3D渲染
    "@react-three/fiber": "^8.15.0",  // React Three.js
    "@react-three/drei": "^9.88.0",   // Three.js辅助组件
    "zustand": "^4.4.0",         // 状态管理
    "react-router-dom": "^6.18.0" // 路由
  }
}
```

### 后端技术栈 (可选，先用本地存储)
- **阶段1**: 纯前端 + localStorage
- **阶段2**: 添加简单的Node.js + JSON文件存储
- **阶段3**: 升级到完整后端

## 3. 界面设计简化

### 主界面布局
```
┌─────────────────────────────────────────────────────────────┐
│ Mini LoongEnv Studio                            [导出配置]  │
├─────────────────────────────────────────────────────────────┤
│ ┌─────────────┐ ┌─────────────────────────────────────────┐ │
│ │   功能导航   │ │              主工作区                    │ │
│ │             │ │                                         │ │
│ │ 📁 项目     │ │                                         │ │
│ │ 🤖 机械臂   │ │          (根据选择显示对应功能)           │ │
│ │ 🎯 轨迹     │ │                                         │ │
│ │ ▶️ 仿真     │ │                                         │ │
│ │             │ │                                         │ │
│ └─────────────┘ └─────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────┤
│ 状态: 就绪 | 当前项目: 6轴装配任务                          │
└─────────────────────────────────────────────────────────────┘
```

### 核心界面简化设计

#### 1. 项目管理 (极简)
```
┌─────────────────────────────────────────────────────────────┐
│ 项目管理                                      [+ 新建项目]  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ 当前项目: [6轴装配任务_____________________] [选择项目 ▼]   │
│                                                             │
│ 项目描述: [工业机械臂装配作业轨迹设计_______________________] │
│                                                             │
│ 机械臂类型: [6轴工业机械臂 ▼]                               │
│                                                             │
│                                    [保存] [删除] [导入]     │
└─────────────────────────────────────────────────────────────┘
```

#### 2. 机械臂配置 (核心简化)
```
┌─────────────────────────────────────────────────────────────┐
│ 机械臂配置                                                  │
├─────────────────────────────────────────────────────────────┤
│ ┌─────────────────┐ ┌─────────────────────────────────────┐ │
│ │ DH参数 (简化)   │ │           3D机械臂模型               │ │
│ │                 │ │                                     │ │
│ │ 关节1: a=0      │ │        ┌─────┐                      │ │
│ │       d=0       │ │        │  6  │                      │ │
│ │       θ=0°      │ │        └──┬──┘                      │ │
│ │ 限制:[-180,180] │ │           │                         │ │
│ │                 │ │        ┌──┴──┐                      │ │
│ │ 关节2: a=420    │ │        │  5  │                      │ │
│ │       d=0       │ │        └──┬──┘                      │ │
│ │       θ=-90°    │ │           │                         │ │
│ │ 限制:[-90,135]  │ │        ┌──┴──┐                      │ │
│ │                 │ │        │  4  │                      │ │
│ │ ... (6个关节)   │ │        └──┬──┘                      │ │
│ │                 │ │           │                         │ │
│ │ [加载预设]      │ │        ┌──┴──┐                      │ │
│ │ [重置默认]      │ │        │ 1-3 │                      │ │
│ └─────────────────┘ │        └─────┘                      │ │
│                     │                                     │ │
│                     │ [正运动学测试] [逆运动学测试]        │ │
│                     └─────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

#### 3. 轨迹设计 (核心简化)
```
┌─────────────────────────────────────────────────────────────┐
│ 轨迹设计                                                    │
├─────────────────────────────────────────────────────────────┤
│ ┌─────────────────┐ ┌─────────────────────────────────────┐ │
│ │ 轨迹点列表      │ │           3D工作空间                 │ │
│ │                 │ │                                     │ │
│ │ P0: 起始点      │ │     Y ↑                             │ │
│ │ X=0,Y=0,Z=500   │ │       │                             │ │
│ │ [编辑] [删除]   │ │       │   ●P2                       │ │
│ │                 │ │       │  ╱                          │ │
│ │ P1: 中间点      │ │       │ ╱                           │ │
│ │ X=200,Y=100,Z=400│ │      │╱                            │ │
│ │ [编辑] [删除]   │ │ ─────●P1──────► X                   │ │
│ │                 │ │     ╱│                              │ │
│ │ P2: 目标点      │ │    ╱ │                              │ │
│ │ X=400,Y=200,Z=300│ │   ╱  ▼ Z                           │ │
│ │ [编辑] [删除]   │ │  ●P0                                │ │
│ │                 │ │                                     │ │
│ │ [添加点]        │ │ 点击空间添加轨迹点                   │ │
│ │ [清空轨迹]      │ │ 拖拽轨迹点修改位置                   │ │
│ │ [轨迹优化]      │ │                                     │ │
│ └─────────────────┘ └─────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

#### 4. 简单仿真 (核心简化)
```
┌─────────────────────────────────────────────────────────────┐
│ 仿真预览                                    [开始] [停止]   │
├─────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────────┐ │
│ │                    仿真场景                              │ │
│ │                                                         │ │
│ │    机械臂运动动画显示                                    │ │
│ │    轨迹路径高亮                                          │ │
│ │    当前位置指示                                          │ │
│ │                                                         │ │
│ │ 进度: ████████░░ 80%                                    │ │
│ │ 时间: 8.0s / 10.0s                                      │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ ┌─────────────────┐ ┌─────────────────────────────────────┐ │
│ │ 仿真控制        │ │           性能指标                   │ │
│ │                 │ │                                     │ │
│ │ 速度: [1x ▼]    │ │ 最大速度: 850 mm/s                  │ │
│ │ 循环: ☐ 启用    │ │ 平均速度: 420 mm/s                  │ │
│ │                 │ │ 总时间: 10.2s                       │ │
│ │ [重置] [暂停]   │ │ 路径长度: 1250mm                    │ │
│ └─────────────────┘ └─────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

## 4. 数据结构简化

### 项目数据结构
```typescript
interface MiniProject {
  id: string;
  name: string;
  description: string;
  robotType: 'industrial_6axis';
  createdAt: string;
  updatedAt: string;
}

interface MiniRobot {
  dhParams: DHParameter[];  // 6个关节的DH参数
  jointLimits: JointLimit[]; // 关节限制
}

interface DHParameter {
  joint: number;
  a: number;    // 连杆长度
  d: number;    // 连杆偏移
  theta: number; // 关节角度
  alpha: number; // 连杆扭转角
}

interface TrajectoryPoint {
  id: string;
  name: string;
  position: [number, number, number]; // [x, y, z]
  orientation?: [number, number, number]; // [rx, ry, rz] 可选
}

interface MiniSimulation {
  duration: number;
  speed: number;
  points: TrajectoryPoint[];
  metrics: {
    maxSpeed: number;
    avgSpeed: number;
    totalTime: number;
    pathLength: number;
  };
}
```

## 5. 开发计划 (4周)

### Week 1: 基础框架
- [x] 项目初始化和基础UI框架
- [ ] 主界面布局和导航
- [ ] 基础状态管理
- [ ] 本地存储功能

### Week 2: 机械臂配置
- [ ] DH参数配置界面
- [ ] 3D机械臂模型显示
- [ ] 正逆运动学计算
- [ ] 关节限制验证

### Week 3: 轨迹设计
- [ ] 3D场景交互
- [ ] 轨迹点添加/编辑
- [ ] 轨迹路径可视化
- [ ] 轨迹数据管理

### Week 4: 仿真和导出
- [ ] 简单运动学仿真
- [ ] 动画播放控制
- [ ] 性能指标计算
- [ ] 配置文件导出

## 6. 技术实现要点

### 关键简化策略
1. **纯前端实现**: 使用localStorage存储，避免后端复杂性
2. **固定机械臂类型**: 只支持6轴工业机械臂
3. **简化运动学**: 只实现基础正逆运动学，不考虑动力学
4. **基础3D渲染**: 使用简单的几何体表示机械臂
5. **线性插值**: 轨迹规划使用简单的线性插值

### 核心算法简化
```typescript
// 简化的正运动学
function forwardKinematics(dhParams: DHParameter[], jointAngles: number[]) {
  // 基础DH变换矩阵计算
  // 返回末端执行器位姿
}

// 简化的逆运动学 (解析解)
function inverseKinematics(targetPose: Pose, dhParams: DHParameter[]) {
  // 6轴机械臂解析逆运动学
  // 返回关节角度解
}

// 简化的轨迹规划
function planTrajectory(points: TrajectoryPoint[]) {
  // 线性插值生成轨迹
  // 返回时间序列的关节角度
}
```

这个mini版本专注于核心工作流，去除了复杂的功能，可以快速验证设计理念和用户体验。需要我开始创建具体的代码实现吗？
